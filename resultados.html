<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="favicon-32x32.png" type="image/x-icon">
    <title>Resultados e Indicadores - NQSP</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <style>
        body { background-color: #f4f7f6; }
        .card { border: none; transition: transform 0.2s; }
        .card:hover { transform: translateY(-5px); }
        .chart-container { position: relative; height: 300px; width: 100%; }
        .indicator-value { font-size: 2rem; font-weight: bold; }

        /* Garante que o texto NQSP seja sempre azul oficial */
        .brand-text span { color: #0d6efd !important; }
    </style>
</head>
<body>

    <nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top shadow-sm">
        <div class="container-fluid px-4">
            <a class="navbar-brand d-flex align-items-center" href="index.html">
                <img src="OIP__1_-removebg-preview.png" alt="" height="50" class="me-2">
                <div class="brand-text">
                    <span class="d-block fw-bold lh-1 text-primary">NQSP</span>
                    <small class="text-muted" style="font-size: 0.7rem;">QUALIDADE E SEGURANÇA</small>
                </div>
            </a>
            <div class="ms-auto d-flex align-items-center">
                <label class="me-2 fw-bold small">MÊS DE REFERÊNCIA:</label>
                <select id="seletorMes" class="form-select form-select-sm w-auto" onchange="atualizarDados()">
                    <option value="out">Outubro/2025</option>
                    <option value="nov">Novembro/2025</option>
                    <option value="dez">Dezembro/2025</option>
                    </select>
            </div>
        </div>
    </nav>

    <div class="container my-5">
        <div class="text-center mb-5">
            <h2 class="fw-bold text-primary">Painel de Indicadores Estratégicos</h2>
            <p class="text-muted">Dados consolidados da Unidade para monitoramento da performance assistencial.</p>
        </div>

        <div class="row mb-4 text-center">
            <div class="col-md-3">
                <div class="card shadow-sm border-start border-primary border-4">
                    <div class="card-body">
                        <p class="text-muted small mb-1">Total de Atendimentos</p>
                        <div class="indicator-value text-primary" id="valAtendimentos">0</div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card shadow-sm border-start border-success border-4">
                    <div class="card-body">
                        <p class="text-muted small mb-1">Média Tempo de Espera</p>
                        <div class="indicator-value text-success" id="valEspera">0</div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card shadow-sm border-start border-warning border-4">
                    <div class="card-body">
                        <p class="text-muted small mb-1">Total de Transferência</p>
                        <div class="indicator-value text-warning" id="valTransf">0</div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card shadow-sm border-start border-danger border-4">
                    <div class="card-body">
                        <p class="text-muted small mb-1">Total de Evasões</p>
                        <div class="indicator-value text-danger" id="valEvasao">0</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-8 mb-4">
                <div class="card shadow-sm h-100 p-3">
                    <h6 class="fw-bold"><i class="bi bi-clock-history me-2"></i>Volume de Atendimento / Classificação de Risco</h6>
                    <div class="chart-container">
                        <canvas id="chartAtendimento"></canvas>
                    </div>
                </div>
            </div>

            <div class="col-md-4 mb-4">
                <div class="card shadow-sm h-100 p-3 text-center">
                    <h6 class="fw-bold"><i class="bi bi-emoji-smile me-2"></i>Satisfação (NPS)</h6>
                    <div class="chart-container">
                        <canvas id="chartSatisfacao"></canvas>
                    </div>
                    <div class="mt-2">
                        <span class="badge bg-success" id="npsLabel">Ótimo/Bom: 0%</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-6 mb-4">
                <div class="card shadow-sm p-3">
                    <h6 class="fw-bold text-danger"><i class="bi bi-person-x me-2"></i>Histórico de Evasões (%)</h6>
                    <div class="chart-container">
                        <canvas id="chartEvasao"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-md-6 mb-4">
                <div class="card shadow-sm p-3">
                    <h6 class="fw-bold text-warning"><i class="bi bi-truck me-2"></i>Hospitais Com Maior Taxa de Transferências Externas</h6>
                    <div class="chart-container">
                        <canvas id="chartTransferencia"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 1. DADOS DOS MESES (Base de dados fictícia)
        const dadosMeses = {
            out: {
                atendimentos: "4.823", espera: "-50 min", transf: "95", evasao: "45", nps: "89%",
                chartAtend: [3425, 1233, 126, 5, 34],
                chartSatis: [65, 24, 8, 3],
                chartEva: [9, 2, 32, 0, 0],
                chartTransf: [50, 27, 6]
            },
            nov: {
                atendimentos: "4.455", espera: "-50 min", transf: "93", evasao: "40", nps: "89%",
                chartAtend: [3033, 1283, 135, 4, 0],
                chartSatis: [40, 20, 2, 1],
                chartEva: [10, 1, 29, 0, 0],
                chartTransf: [58, 22,]
            },
            dez: {
                atendimentos: "4.100", espera: "48 min", transf: "80", evasao: "30", nps: "85%",
                chartAtend: [2800, 950, 250, 100, 0],
                chartSatis: [60, 25, 10, 5],
                chartEva: [1.1, 0.5, 0.8, 0.6, 0.7],
                chartTransf: [42, 33, 40, 35, 38]
            }
        };

        // Variáveis para armazenar as instâncias dos gráficos
        let chartAtendimento, chartSatisfacao, chartEvasao, chartTransferencia;

        function inicializarGraficos() {
            Chart.defaults.font.family = 'Segoe UI';
            Chart.defaults.plugins.legend.position = 'bottom';

            const ctxAtend = document.getElementById('chartAtendimento').getContext('2d');
            chartAtendimento = new Chart(ctxAtend, {
                type: 'bar',
                data: {
                    labels: ['Verde', 'Amarelo', 'Laranja', 'Vermelho', 'Azul'],
                    datasets: [{
                        label: 'Atendimentos',
                        backgroundColor: 'rgba(13, 110, 253, 0.2)',
                        borderColor: '#0d6efd',
                        borderWidth: 1,
                        data: []
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false }
            });

            const ctxSatis = document.getElementById('chartSatisfacao').getContext('2d');
            chartSatisfacao = new Chart(ctxSatis, {
                type: 'doughnut',
                data: {
                    labels: ['Ótimo', 'Bom', 'Regular', 'Ruim'],
                    datasets: [{
                        backgroundColor: ['#198754', '#0dcaf0', '#ffc107', '#dc3545'],
                        data: []
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false }
            });

            const ctxEva = document.getElementById('chartEvasao').getContext('2d');
            chartEvasao = new Chart(ctxEva, {
                type: 'line',
                data: {
                    labels: ['Amarela', 'Pediatria', 'Medicação', 'Classificação', 'Vermelha'],
                    datasets: [{
                        label: 'Taxa %',
                        borderColor: '#dc3545',
                        fill: false,
                        data: []
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false }
            });

            const ctxTransf = document.getElementById('chartTransferencia').getContext('2d');
            chartTransferencia = new Chart(ctxTransf, {
                type: 'bar',
                data: {
                    labels: ['HCB', 'HGE', 'SCP'],
                    datasets: [{
                        label: 'Pacientes Transferidos',
                        backgroundColor: '#ffc107',
                        data: []
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false }
            });
        }

        function atualizarDados() {
            const mesSelecionado = document.getElementById('seletorMes').value;
            const dados = dadosMeses[mesSelecionado];

            if (!dados) return;

            // Atualiza os Cards
            document.getElementById('valAtendimentos').innerText = dados.atendimentos;
            document.getElementById('valEspera').innerText = dados.espera;
            document.getElementById('valTransf').innerText = dados.transf;
            document.getElementById('valEvasao').innerText = dados.evasao;
            document.getElementById('npsLabel').innerText = `Ótimo/Bom: ${dados.nps}`;

            // Atualiza os Gráficos
            chartAtendimento.data.datasets[0].data = dados.chartAtend;
            chartAtendimento.update();

            chartSatisfacao.data.datasets[0].data = dados.chartSatis;
            chartSatisfacao.update();

            chartEvasao.data.datasets[0].data = dados.chartEva;
            chartEvasao.update();

            chartTransferencia.data.datasets[0].data = dados.chartTransf;
            chartTransferencia.update();
        }

        // Inicia o painel com Janeiro
        window.onload = () => {
            inicializarGraficos();
            atualizarDados();
        };
    </script>
</body>
</html>